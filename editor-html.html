<!doctype html>
<html lang="it">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Editor HTML Semplice</title>
  <style>
body {
  box-sizing: border-box;
}
    * { 
        margin: 0px;
        padding: 0px;
        box-sizing: border-box; 
    }

    html, body { 
        height: 100%;
        width: 100%;
    }

    body { 
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; 
        background: rgb(26, 26, 26);
        color: white; 
        display: flex; 
        flex-direction: column;
    }

    .header { 
        background: rgb(45, 45, 45); 
        padding: 15px 20px; 
        border-bottom: 1px solid rgb(68, 68, 68); 
        display: flex;
        gap: 10px; 
        flex-wrap: wrap; 
    }

    .btn { 
        background: rgb(0, 122, 204);
        color: white; 
        border: none;
        padding: 8px 16px; 
        border-radius: 4px; 
        cursor: pointer; 
        font-size: 14px;
        transition: background 0.2s; 
    }

    .btn:hover { 
        background: rgb(0, 90, 158); 
    }

    .btn.danger { 
        background: rgb(220, 53, 69);
    }

    .btn.danger:hover {
        background: rgb(200, 35, 51);
    }

    .btn.success { 
        background: rgb(40, 167, 69); 
    }

    .btn.success:hover { 
        background: rgb(33, 136, 56); 
    }

    .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .main-container { 
        flex: 1;
        display: flex; 
        overflow: hidden;
    }

    .editor-container { 
        flex: 1; 
        display: flex;
        flex-direction: column; 
        border-right: 1px solid rgb(68, 68, 68); 
    }

    .editor-header { 
        background: rgb(45, 45, 45); 
        padding: 10px 15px; 
        border-bottom: 1px solid rgb(68, 68, 68); 
        font-size: 14px; 
        color: rgb(204, 204, 204); 
    }

    .editor { 
        flex: 1;
        background: rgb(30, 30, 30);
        color: rgb(212, 212, 212); 
        border: none; 
        outline: none; 
        padding: 15px;
        font-family: Consolas, Monaco, "Courier New", monospace; 
        font-size: 14px; 
        line-height: 1.5; 
        resize: none; 
        tab-size: 2; 
    }

    .preview-container { 
        flex: 1;
        display: flex; 
        flex-direction: column; 
    }

    .preview-header { 
        background: rgb(45, 45, 45);
        padding: 10px 15px; 
        border-bottom: 1px solid rgb(68, 68, 68); 
        font-size: 14px;
        color: rgb(204, 204, 204);
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
    }

    .preview-frame { 
        flex: 1; 
        border: none; 
        background: white; 
    }

    .file-input { 
        display: none; 
    }

    .status { 
        background: rgb(45, 45, 45); 
        padding: 8px 15px; 
        border-top: 1px solid rgb(68, 68, 68); 
        font-size: 12px; 
        color: rgb(136, 136, 136); 
        display: flex; 
        justify-content: space-between; 
    }

    .versions-panel {
        position: fixed;
        top: 0;
        right: -400px;
        width: 400px;
        height: 100%;
        background: rgb(35, 35, 35);
        border-left: 1px solid rgb(68, 68, 68);
        transition: right 0.3s;
        z-index: 1000;
        display: flex;
        flex-direction: column;
    }

    .versions-panel.open {
        right: 0;
    }

    .versions-header {
        background: rgb(45, 45, 45);
        padding: 15px;
        border-bottom: 1px solid rgb(68, 68, 68);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .versions-list {
        flex: 1;
        overflow-y: auto;
        padding: 15px;
    }

    .version-item {
        background: rgb(45, 45, 45);
        padding: 12px;
        margin-bottom: 10px;
        border-radius: 4px;
        cursor: pointer;
        transition: background 0.2s;
    }

    .version-item:hover {
        background: rgb(55, 55, 55);
    }

    .version-name {
        font-weight: bold;
        margin-bottom: 5px;
    }

    .version-date {
        font-size: 12px;
        color: rgb(136, 136, 136);
    }

    .delete-version-btn {
        background: rgb(220, 53, 69);
        color: white;
        border: none;
        padding: 4px 8px;
        border-radius: 3px;
        cursor: pointer;
        font-size: 11px;
        margin-top: 8px;
        transition: background 0.2s;
    }

    .delete-version-btn:hover {
        background: rgb(200, 35, 51);
    }

    .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        z-index: 999;
    }

    .overlay.visible {
        display: block;
    }

    .toast {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: rgb(40, 167, 69);
        color: white;
        padding: 12px 20px;
        border-radius: 4px;
        display: none;
        z-index: 1001;
        animation: slideIn 0.3s;
    }

    .toast.visible {
        display: block;
    }

    @keyframes slideIn {
        from {
            transform: translateX(400px);
        }
        to {
            transform: translateX(0);
        }
    }

    @media (max-width: 768px) {
        .main-container { 
            flex-direction: column; 
        }
        .editor-container { 
            border-right: none; 
            border-bottom: 1px solid rgb(68, 68, 68); 
            height: 50%; 
        }
        .preview-container { 
            height: 50%; 
        }
        .header { 
            padding: 10px; 
            gap: 8px; 
        }
        .btn { 
            padding: 6px 12px; 
            font-size: 12px; 
        }
        .versions-panel {
            width: 100%;
            right: -100%;
        }
    }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="header"><button class="btn" id="newBtn">üìÑ Nuovo</button> <button class="btn" id="loadBtn">üìÅ Carica</button> <button class="btn success" id="saveBtn">üíæ Salva</button> <button class="btn" id="downloadBtn">‚¨áÔ∏è Download</button> <button class="btn danger" id="resetBtn">üóëÔ∏è Reset</button> <button class="btn" id="versionsBtn">üïí Versioni</button> <button class="btn" id="copyBtn">üìã Copia</button> <input type="file" id="fileInput" class="file-input" accept=".html,.htm">
  </div>
  <div class="main-container">
   <div class="editor-container">
    <div class="editor-header" id="editorTitle">
     üìù Editor HTML
    </div><textarea id="htmlEditor" class="editor" placeholder="Scrivi il tuo codice HTML qui..."></textarea>
   </div>
   <div class="preview-container">
    <div class="preview-header"><span id="previewTitle">üëÅÔ∏è Anteprima</span> <button class="btn" id="refreshBtn">üîÑ Aggiorna</button>
    </div><iframe id="previewFrame" class="preview-frame"></iframe>
   </div>
  </div>
  <div class="status"><span id="fileInfo">documento_senza_titolo.html</span> <span id="stats">0 caratteri, 0 righe</span>
  </div>
  <div class="overlay" id="overlay"></div>
  <div class="versions-panel" id="versionsPanel">
   <div class="versions-header"><span>üìÅ Versioni salvate</span> <button class="btn" id="closeVersionsBtn">‚úï</button>
   </div>
   <div class="versions-list" id="versionsList"></div>
  </div>
  <div class="toast" id="toast"></div>
  <script>
        let currentDocumentId = null;
        let isModified = false;
        let savedVersions = [];

        const htmlEditor = document.getElementById('htmlEditor');
        
        // Template HTML iniziale
        const initialTemplate = `<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Mia Pagina</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        h1 {
            text-align: center;
            font-size: 2.5em;
        }
        p {
            line-height: 1.6;
            font-size: 1.1em;
        }
        .button {
            display: inline-block;
            padding: 12px 24px;
            background: white;
            color: #667eea;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            margin-top: 20px;
        }
        .button:hover {
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <h1>Benvenuto nel tuo Editor HTML! üé®</h1>
    <p>Questo √® un template di esempio. Modifica il codice a sinistra per vedere i cambiamenti in tempo reale nell'anteprima.</p>
    <p>Puoi cambiare colori, aggiungere immagini, creare form e molto altro!</p>
    <a href="#" class="button">Inizia a Creare</a>
</body>
</html>`;

        // Carica il template iniziale
        htmlEditor.value = initialTemplate;
        const previewFrame = document.getElementById('previewFrame');
        const fileInfo = document.getElementById('fileInfo');
        const stats = document.getElementById('stats');
        const newBtn = document.getElementById('newBtn');
        const loadBtn = document.getElementById('loadBtn');
        const saveBtn = document.getElementById('saveBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const resetBtn = document.getElementById('resetBtn');
        const versionsBtn = document.getElementById('versionsBtn');
        const copyBtn = document.getElementById('copyBtn');
        const refreshBtn = document.getElementById('refreshBtn');
        const fileInput = document.getElementById('fileInput');
        const versionsPanel = document.getElementById('versionsPanel');
        const versionsList = document.getElementById('versionsList');
        const closeVersionsBtn = document.getElementById('closeVersionsBtn');
        const overlay = document.getElementById('overlay');
        const toast = document.getElementById('toast');

        function updatePreview() {
            const content = htmlEditor.value;
            const doc = previewFrame.contentDocument || previewFrame.contentWindow.document;
            doc.open();
            doc.write(content);
            doc.close();
        }

        function updateStats() {
            const content = htmlEditor.value;
            const chars = content.length;
            const lines = content.split('\n').length;
            stats.textContent = `${chars} caratteri, ${lines} righe`;
        }

        function showToast(message) {
            toast.textContent = message;
            toast.classList.add('visible');
            setTimeout(() => {
                toast.classList.remove('visible');
            }, 3000);
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        htmlEditor.addEventListener('input', () => {
            isModified = true;
            updateStats();
            updatePreview();
            updateFileInfo();
        });

        refreshBtn.addEventListener('click', () => {
            updatePreview();
            showToast('Anteprima aggiornata');
        });

        newBtn.addEventListener('click', () => {
            if (isModified) {
                const newDocBtn = document.createElement('button');
                newDocBtn.className = 'btn';
                newDocBtn.textContent = 'Conferma nuovo documento';
                newDocBtn.style.position = 'fixed';
                newDocBtn.style.top = '50%';
                newDocBtn.style.left = '50%';
                newDocBtn.style.transform = 'translate(-50%, -50%)';
                newDocBtn.style.zIndex = '1002';
                
                const cancelBtn = document.createElement('button');
                cancelBtn.className = 'btn danger';
                cancelBtn.textContent = 'Annulla';
                cancelBtn.style.position = 'fixed';
                cancelBtn.style.top = '50%';
                cancelBtn.style.left = '50%';
                cancelBtn.style.transform = 'translate(-50%, calc(-50% + 50px))';
                cancelBtn.style.zIndex = '1002';
                
                document.body.appendChild(newDocBtn);
                document.body.appendChild(cancelBtn);
                overlay.classList.add('visible');
                
                newDocBtn.addEventListener('click', () => {
                    htmlEditor.value = '';
                    currentDocumentId = null;
                    isModified = false;
                    updatePreview();
                    updateStats();
                    updateFileInfo();
                    document.body.removeChild(newDocBtn);
                    document.body.removeChild(cancelBtn);
                    overlay.classList.remove('visible');
                    showToast('Nuovo documento creato');
                });
                
                cancelBtn.addEventListener('click', () => {
                    document.body.removeChild(newDocBtn);
                    document.body.removeChild(cancelBtn);
                    overlay.classList.remove('visible');
                });
            } else {
                htmlEditor.value = '';
                currentDocumentId = null;
                updatePreview();
                updateStats();
                updateFileInfo();
                showToast('Nuovo documento creato');
            }
        });

        loadBtn.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    htmlEditor.value = event.target.result;
                    currentDocumentId = null;
                    isModified = false;
                    updatePreview();
                    updateStats();
                    fileInfo.textContent = file.name;
                    showToast(`File ${file.name} caricato`);
                };
                reader.readAsText(file);
            }
        });

        saveBtn.addEventListener('click', () => {
            const content = htmlEditor.value;
            const name = `versione_${Date.now()}`;
            
            const version = {
                id: generateId(),
                name: name,
                content: content,
                createdAt: new Date().toISOString(),
                modifiedAt: new Date().toISOString()
            };
            
            savedVersions.unshift(version);
            localStorage.setItem('htmlEditorVersions', JSON.stringify(savedVersions));
            
            isModified = false;
            updateFileInfo();
            showToast('Documento salvato in locale');
            renderVersionsList();
        });

        downloadBtn.addEventListener('click', () => {
            const content = htmlEditor.value;
            const blob = new Blob([content], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'documento.html';
            a.click();
            URL.revokeObjectURL(url);
            showToast('Download avviato');
        });

        resetBtn.addEventListener('click', () => {
            const confirmBtn = document.createElement('button');
            confirmBtn.className = 'btn danger';
            confirmBtn.textContent = 'Conferma Reset';
            confirmBtn.style.position = 'fixed';
            confirmBtn.style.top = '50%';
            confirmBtn.style.left = '50%';
            confirmBtn.style.transform = 'translate(-50%, -50%)';
            confirmBtn.style.zIndex = '1002';
            
            const cancelBtn = document.createElement('button');
            cancelBtn.className = 'btn';
            cancelBtn.textContent = 'Annulla';
            cancelBtn.style.position = 'fixed';
            cancelBtn.style.top = '50%';
            cancelBtn.style.left = '50%';
            cancelBtn.style.transform = 'translate(-50%, calc(-50% + 50px))';
            cancelBtn.style.zIndex = '1002';
            
            document.body.appendChild(confirmBtn);
            document.body.appendChild(cancelBtn);
            overlay.classList.add('visible');
            
            confirmBtn.addEventListener('click', () => {
                htmlEditor.value = initialTemplate;
                currentDocumentId = null;
                isModified = false;
                updatePreview();
                updateStats();
                updateFileInfo();
                document.body.removeChild(confirmBtn);
                document.body.removeChild(cancelBtn);
                overlay.classList.remove('visible');
                showToast('Editor resettato');
            });
            
            cancelBtn.addEventListener('click', () => {
                document.body.removeChild(confirmBtn);
                document.body.removeChild(cancelBtn);
                overlay.classList.remove('visible');
            });
        });

        versionsBtn.addEventListener('click', () => {
            versionsPanel.classList.add('open');
            overlay.classList.add('visible');
            renderVersionsList();
        });

        closeVersionsBtn.addEventListener('click', () => {
            versionsPanel.classList.remove('open');
            overlay.classList.remove('visible');
        });

        overlay.addEventListener('click', () => {
            versionsPanel.classList.remove('open');
            overlay.classList.remove('visible');
        });

        copyBtn.addEventListener('click', () => {
            const content = htmlEditor.value;
            const textArea = document.createElement('textarea');
            textArea.value = content;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showToast('Codice copiato negli appunti');
            } catch (err) {
                showToast('Errore durante la copia');
            }
            document.body.removeChild(textArea);
        });

        function updateFileInfo() {
            const modified = isModified ? ' (modificato)' : '';
            const filename = currentDocumentId ? `versione_salvata.html` : 'documento_senza_titolo.html';
            fileInfo.textContent = filename + modified;
        }

        function renderVersionsList() {
            versionsList.innerHTML = '';
            if (savedVersions.length === 0) {
                versionsList.innerHTML = '<div style="text-align: center; color: rgb(136, 136, 136); padding: 20px;">Nessuna versione salvata</div>';
                return;
            }

            savedVersions.forEach((version, index) => {
                const item = document.createElement('div');
                item.className = 'version-item';
                
                const name = document.createElement('div');
                name.className = 'version-name';
                name.textContent = version.name;
                
                const date = document.createElement('div');
                date.className = 'version-date';
                const versionDate = new Date(version.createdAt);
                date.textContent = versionDate.toLocaleString('it-IT');
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-version-btn';
                deleteBtn.textContent = 'üóëÔ∏è Elimina';
                deleteBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    savedVersions.splice(index, 1);
                    localStorage.setItem('htmlEditorVersions', JSON.stringify(savedVersions));
                    renderVersionsList();
                    showToast('Versione eliminata');
                });
                
                item.appendChild(name);
                item.appendChild(date);
                item.appendChild(deleteBtn);
                
                item.addEventListener('click', () => {
                    htmlEditor.value = version.content;
                    currentDocumentId = version.id;
                    isModified = false;
                    updatePreview();
                    updateStats();
                    updateFileInfo();
                    versionsPanel.classList.remove('open');
                    overlay.classList.remove('visible');
                    showToast('Versione caricata');
                });
                
                versionsList.appendChild(item);
            });
        }

        // Carica versioni salvate dal localStorage
        const storedVersions = localStorage.getItem('htmlEditorVersions');
        if (storedVersions) {
            savedVersions = JSON.parse(storedVersions);
        }

        // Inizializza l'editor con il template
        updateStats();
        updateFileInfo();
        updatePreview();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b925bf095275267',t:'MTc2NzYwOTY0My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>